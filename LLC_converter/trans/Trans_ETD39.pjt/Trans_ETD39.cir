*****************************************************
*   PExprt FEA BASED MODEL FOR MAGNETIC COMPONENT   *
*            PSPICE (R) LANGUAGE VERSION            *
* GENERATED BY PExprt (TM). © 2022 UPM-SAS IP, Inc. *
*                  Release 2022 R2                  *
*****************************************************
*          Frequency Domain Model Version           *
*****************************************************


.lib impedanc.lib

.subckt Trans_ETD39 Ap_center Am_center Bp_center Bm_center Cp_center Cm_center Dp_center Dm_center 

* Thermal Nodes for Magnetic Component

+AvgTotalLosses 

+AvgCoreLosses 

+AvgWireLosses 

+TotalLosses 

+CoreLosses 

+WireLosses 



vsens1 Ap_center N1_1 0
hsens1 isens1 0 vsens1 1


vsens2 Bp_center N2_1 0
hsens2 isens2 0 vsens2 1


vsens3 Cp_center N3_1 0
hsens3 isens3 0 vsens3 1


vsens4 Dp_center N4_1 0
hsens4 isens4 0 vsens4 1



* Inductances 1.

L_1 N1_5 Am_center 8.018048e-05

R_Eddy1 N1_5 Am_center {R_Eddy1}

.PARAM R_Eddy1=1.202119e+06  

* Inductances 2.

L_2 N2_5 Bm_center 1.636336e-06

R_Eddy2 N2_5 Bm_center {R_Eddy2}

.PARAM R_Eddy2=2.453304e+04  

* Inductances 3.

L_3 N3_5 Cm_center 1.636336e-06

R_Eddy3 N3_5 Cm_center {R_Eddy3}

.PARAM R_Eddy3=2.453304e+04  

* Inductances 4.

L_4 N4_5 Dm_center 1.636336e-06

R_Eddy4 N4_5 Dm_center {R_Eddy4}

.PARAM R_Eddy4=2.453304e+04  


K_core L_1 L_2 L_3 L_4  1 


* Z1_1.

XSIMP1_1 N1_1 N1_2 s_imp PARAMS:
+   C0 = 0.012902,
+   C1 = 2.06936e-05,
+   C2 = 1.61266,
+   C3 = 2.82876e+07,
+   C4 = 26.3222,
+   C5 = 1.12744e+09,
+   C6 = 34.7323,
+   C7 = 2.53671e+08


* Z1_2.

XMIMP1_2 N1_2 N1_3 isens2 m_imp PARAMS:
+   C0 = -8.60722e-05,
+   C1 = 1.80338e-06,
+   C2 = -0.00102527,
+   C3 = 3.08137e+07,
+   C4 = -0.140378,
+   C5 = 9.89241e+06,
+   C6 = -0.0070702,
+   C7 = 3.43153e+06,
+   C8 = 0.11519,
+   C9 = 2.82876e+07,
+   C10 = 1.88016,
+   C11 = 1.12744e+09,
+   C12 = 2.48088,
+   C13 = 2.53671e+08,
+   C14 = 2447.84,
+   C15 = 3.93105e+09,
+   C16 = 2.15618,
+   C17 = 2.65673e+08,
+   C18 = 28.1482,
+   C19 = 1.87119e+08


* Z1_3.

XMIMP1_3 N1_3 N1_4 isens3 m_imp PARAMS:
+   C0 = -0.000212496,
+   C1 = 2.59573e-06,
+   C2 = -0.331448,
+   C3 = 1.63347e+07,
+   C4 = -0.0129962,
+   C5 = 4.57422e+07,
+   C6 = -0.0628048,
+   C7 = 1.23352e+07,
+   C8 = 0.11519,
+   C9 = 2.82876e+07,
+   C10 = 1.88016,
+   C11 = 1.12744e+09,
+   C12 = 2.48088,
+   C13 = 2.53671e+08,
+   C14 = 0.606946,
+   C15 = 1.34624e+08,
+   C16 = 0.130194,
+   C17 = 7.20109e+08,
+   C18 = 1.76711,
+   C19 = 3.77459e+07


* Z1_4.

XMIMP1_4 N1_4 N1_5 isens4 m_imp PARAMS:
+   C0 = 0.000658999,
+   C1 = 2.534e-06,
+   C2 = -0.00579422,
+   C3 = 8.88034e+07,
+   C4 = -0.110827,
+   C5 = 5.7482e+06,
+   C6 = -0.00247023,
+   C7 = 2.30365e+09,
+   C8 = 0.11519,
+   C9 = 2.82876e+07,
+   C10 = 1.88016,
+   C11 = 1.12744e+09,
+   C12 = 2.48088,
+   C13 = 2.53671e+08,
+   C14 = 0.128779,
+   C15 = 2.50703e+07,
+   C16 = 12.3831,
+   C17 = 2.63627e+08,
+   C18 = 8.02644,
+   C19 = 9.13198e+07


* Z2_1.

XMIMP2_1 N2_1 N2_2 isens1 m_imp PARAMS:
+   C0 = -8.60722e-05,
+   C1 = 1.80338e-06,
+   C2 = -0.00102527,
+   C3 = 3.08137e+07,
+   C4 = -0.140378,
+   C5 = 9.89241e+06,
+   C6 = -0.0070702,
+   C7 = 3.43153e+06,
+   C8 = 0.11519,
+   C9 = 2.82876e+07,
+   C10 = 1.88016,
+   C11 = 1.12744e+09,
+   C12 = 2.48088,
+   C13 = 2.53671e+08,
+   C14 = 2447.84,
+   C15 = 3.93105e+09,
+   C16 = 2.15618,
+   C17 = 2.65673e+08,
+   C18 = 28.1482,
+   C19 = 1.87119e+08


* Z2_2.

XSIMP2_2 N2_2 N2_3 s_imp PARAMS:
+   C0 = 0.00154722,
+   C1 = 7.06198e-07,
+   C2 = 699.382,
+   C3 = 3.93105e+09,
+   C4 = 0.616053,
+   C5 = 2.65673e+08,
+   C6 = 8.04234,
+   C7 = 1.87119e+08


* Z2_3.

XMIMP2_3 N2_3 N2_4 isens3 m_imp PARAMS:
+   C0 = 4.18682e-05,
+   C1 = 7.56655e-07,
+   C2 = -0.0231019,
+   C3 = 5.72114e+06,
+   C4 = -5.77659e-05,
+   C5 = 2.17381e+08,
+   C6 = -0.0901567,
+   C7 = 3.65008e+09,
+   C8 = 349.691,
+   C9 = 3.93105e+09,
+   C10 = 0.308026,
+   C11 = 2.65673e+08,
+   C12 = 4.02117,
+   C13 = 1.87119e+08,
+   C14 = 0.0867065,
+   C15 = 1.34624e+08,
+   C16 = 0.0185992,
+   C17 = 7.20109e+08,
+   C18 = 0.252444,
+   C19 = 3.77459e+07


* Z2_4.

XMIMP2_4 N2_4 N2_5 isens4 m_imp PARAMS:
+   C0 = -1.65171e-05,
+   C1 = 7.01038e-07,
+   C2 = -0.000118488,
+   C3 = 6.5771e+06,
+   C4 = -1.94492e-05,
+   C5 = 2.21433e+08,
+   C6 = -0.0803845,
+   C7 = 1.41786e+07,
+   C8 = 349.691,
+   C9 = 3.93105e+09,
+   C10 = 0.308026,
+   C11 = 2.65673e+08,
+   C12 = 4.02117,
+   C13 = 1.87119e+08,
+   C14 = 0.018397,
+   C15 = 2.50703e+07,
+   C16 = 1.76902,
+   C17 = 2.63627e+08,
+   C18 = 1.14663,
+   C19 = 9.13198e+07


* Z3_1.

XMIMP3_1 N3_1 N3_2 isens1 m_imp PARAMS:
+   C0 = -0.000212496,
+   C1 = 2.59573e-06,
+   C2 = -0.331448,
+   C3 = 1.63347e+07,
+   C4 = -0.0129962,
+   C5 = 4.57422e+07,
+   C6 = -0.0628048,
+   C7 = 1.23352e+07,
+   C8 = 0.11519,
+   C9 = 2.82876e+07,
+   C10 = 1.88016,
+   C11 = 1.12744e+09,
+   C12 = 2.48088,
+   C13 = 2.53671e+08,
+   C14 = 0.606946,
+   C15 = 1.34624e+08,
+   C16 = 0.130194,
+   C17 = 7.20109e+08,
+   C18 = 1.76711,
+   C19 = 3.77459e+07


* Z3_2.

XMIMP3_2 N3_2 N3_3 isens2 m_imp PARAMS:
+   C0 = 4.18682e-05,
+   C1 = 7.56655e-07,
+   C2 = -0.0231019,
+   C3 = 5.72114e+06,
+   C4 = -5.77659e-05,
+   C5 = 2.17381e+08,
+   C6 = -0.0901567,
+   C7 = 3.65008e+09,
+   C8 = 349.691,
+   C9 = 3.93105e+09,
+   C10 = 0.308026,
+   C11 = 2.65673e+08,
+   C12 = 4.02117,
+   C13 = 1.87119e+08,
+   C14 = 0.0867065,
+   C15 = 1.34624e+08,
+   C16 = 0.0185992,
+   C17 = 7.20109e+08,
+   C18 = 0.252444,
+   C19 = 3.77459e+07


* Z3_3.

XSIMP3_3 N3_3 N3_4 s_imp PARAMS:
+   C0 = 0.00184529,
+   C1 = 9.19761e-07,
+   C2 = 0.173413,
+   C3 = 1.34624e+08,
+   C4 = 0.0371984,
+   C5 = 7.20109e+08,
+   C6 = 0.504888,
+   C7 = 3.77459e+07


* Z3_4.

XMIMP3_4 N3_4 N3_5 isens4 m_imp PARAMS:
+   C0 = 7.08284e-05,
+   C1 = 8.70396e-07,
+   C2 = -0.00704396,
+   C3 = 6.43532e+06,
+   C4 = -0.00113864,
+   C5 = 1.22184e+10,
+   C6 = -0.0431096,
+   C7 = 1.05517e+07,
+   C8 = 0.0867065,
+   C9 = 1.34624e+08,
+   C10 = 0.0185992,
+   C11 = 7.20109e+08,
+   C12 = 0.252444,
+   C13 = 3.77459e+07,
+   C14 = 0.018397,
+   C15 = 2.50703e+07,
+   C16 = 1.76902,
+   C17 = 2.63627e+08,
+   C18 = 1.14663,
+   C19 = 9.13198e+07


* Z4_1.

XMIMP4_1 N4_1 N4_2 isens1 m_imp PARAMS:
+   C0 = 0.000658999,
+   C1 = 2.534e-06,
+   C2 = -0.00579422,
+   C3 = 8.88034e+07,
+   C4 = -0.110827,
+   C5 = 5.7482e+06,
+   C6 = -0.00247023,
+   C7 = 2.30365e+09,
+   C8 = 0.11519,
+   C9 = 2.82876e+07,
+   C10 = 1.88016,
+   C11 = 1.12744e+09,
+   C12 = 2.48088,
+   C13 = 2.53671e+08,
+   C14 = 0.128779,
+   C15 = 2.50703e+07,
+   C16 = 12.3831,
+   C17 = 2.63627e+08,
+   C18 = 8.02644,
+   C19 = 9.13198e+07


* Z4_2.

XMIMP4_2 N4_2 N4_3 isens2 m_imp PARAMS:
+   C0 = -1.65171e-05,
+   C1 = 7.01038e-07,
+   C2 = -0.000118488,
+   C3 = 6.5771e+06,
+   C4 = -1.94492e-05,
+   C5 = 2.21433e+08,
+   C6 = -0.0803845,
+   C7 = 1.41786e+07,
+   C8 = 349.691,
+   C9 = 3.93105e+09,
+   C10 = 0.308026,
+   C11 = 2.65673e+08,
+   C12 = 4.02117,
+   C13 = 1.87119e+08,
+   C14 = 0.018397,
+   C15 = 2.50703e+07,
+   C16 = 1.76902,
+   C17 = 2.63627e+08,
+   C18 = 1.14663,
+   C19 = 9.13198e+07


* Z4_3.

XMIMP4_3 N4_3 N4_4 isens3 m_imp PARAMS:
+   C0 = 7.08284e-05,
+   C1 = 8.70396e-07,
+   C2 = -0.00704396,
+   C3 = 6.43532e+06,
+   C4 = -0.00113864,
+   C5 = 1.22184e+10,
+   C6 = -0.0431096,
+   C7 = 1.05517e+07,
+   C8 = 0.0867065,
+   C9 = 1.34624e+08,
+   C10 = 0.0185992,
+   C11 = 7.20109e+08,
+   C12 = 0.252444,
+   C13 = 3.77459e+07,
+   C14 = 0.018397,
+   C15 = 2.50703e+07,
+   C16 = 1.76902,
+   C17 = 2.63627e+08,
+   C18 = 1.14663,
+   C19 = 9.13198e+07


* Z4_4.

XSIMP4_4 N4_4 N4_5 s_imp PARAMS:
+   C0 = 0.00233163,
+   C1 = 9.51566e-07,
+   C2 = 0.0367941,
+   C3 = 2.50703e+07,
+   C4 = 3.53804,
+   C5 = 2.63627e+08,
+   C6 = 2.29327,
+   C7 = 9.13198e+07


*.. Losses Distribution of Magnetic Component

glosses 0 Power VALUE={

+(v(Ap_center)-v(Am_center))*i(vsens1)

++(v(Bp_center)-v(Bm_center))*i(vsens2)

++(v(Cp_center)-v(Cm_center))*i(vsens3)

++(v(Dp_center)-v(Dm_center))*i(vsens4)}

Cavgpower Power 0  1 IC=0.0 

Ravgpower Power 0  1.0e+006 

GaverageLosses 0 AvgTotalLosses VALUE={v(Power)/(TIME+1.0e-012)} 

ginstlosses 0 TotalLosses VALUE={

+(v(Ap_center)-v(Am_center))*i(vsens1)

++(v(Bp_center)-v(Bm_center))*i(vsens2)

++(v(Cp_center)-v(Cm_center))*i(vsens3)

++(v(Dp_center)-v(Dm_center))*i(vsens4)}

GCorelosses 0 CorePower VALUE={

+((v(Ap_center)-v(Am_center))*(v(Ap_center)-v(Am_center)))/R_Eddy1

++(v(Bp_center)-v(Bm_center))*(v(Bp_center)-v(Bm_center))/R_Eddy2

++(v(Cp_center)-v(Cm_center))*(v(Cp_center)-v(Cm_center))/R_Eddy3

++(v(Dp_center)-v(Dm_center))*(v(Dp_center)-v(Dm_center))/R_Eddy4}

CavgCorepower CorePower 0  1 IC=0.0 

RavgCorepower CorePower 0  1.0e+006 

GaverageCoreLosses 0 AvgCoreLosses VALUE={v(CorePower)/(TIME+1.0e-012)} 

GinstCorelosses 0 CoreLosses VALUE={

+((v(Ap_center)-v(Am_center))*(v(Ap_center)-v(Am_center)))/R_Eddy1

++(v(Bp_center)-v(Bm_center))*(v(Bp_center)-v(Bm_center))/R_Eddy2

++(v(Cp_center)-v(Cm_center))*(v(Cp_center)-v(Cm_center))/R_Eddy3

++(v(Dp_center)-v(Dm_center))*(v(Dp_center)-v(Dm_center))/R_Eddy4}

GCondlosses 0 CondPower VALUE={

+(v(Ap_center)-v(Am_center))*i(vsens1)

++(v(Bp_center)-v(Bm_center))*i(vsens2)

++(v(Cp_center)-v(Cm_center))*i(vsens3)

++(v(Dp_center)-v(Dm_center))*i(vsens4)

+-((v(Ap_center)-v(Am_center))*(v(Ap_center)-v(Am_center)))/R_Eddy1

+-(v(Bp_center)-v(Bm_center))*(v(Bp_center)-v(Bm_center))/R_Eddy2

+-(v(Cp_center)-v(Cm_center))*(v(Cp_center)-v(Cm_center))/R_Eddy3

+-(v(Dp_center)-v(Dm_center))*(v(Dp_center)-v(Dm_center))/R_Eddy4}

GinstCondlosses 0 WireLosses VALUE={

+(v(Ap_center)-v(Am_center))*i(vsens1)

++(v(Bp_center)-v(Bm_center))*i(vsens2)

++(v(Cp_center)-v(Cm_center))*i(vsens3)

++(v(Dp_center)-v(Dm_center))*i(vsens4)

+-((v(Ap_center)-v(Am_center))*(v(Ap_center)-v(Am_center)))/R_Eddy1

+-(v(Bp_center)-v(Bm_center))*(v(Bp_center)-v(Bm_center))/R_Eddy2

+-(v(Cp_center)-v(Cm_center))*(v(Cp_center)-v(Cm_center))/R_Eddy3

+-(v(Dp_center)-v(Dm_center))*(v(Dp_center)-v(Dm_center))/R_Eddy4}

CavgCondpower CondPower 0  1 IC=0.0 

RavgCondpower CondPower 0  1.0e+006 

GaverageCondLosses 0 AvgWireLosses VALUE={v(CondPower)/(TIME+1.0e-012)} 

ECoreLosses Core 0 VALUE={

+((v(Ap_center)-v(Am_center))*(v(Ap_center)-v(Am_center)))/R_Eddy1

++(v(Bp_center)-v(Bm_center))*(v(Bp_center)-v(Bm_center))/R_Eddy2

++(v(Cp_center)-v(Cm_center))*(v(Cp_center)-v(Cm_center))/R_Eddy3

++(v(Dp_center)-v(Dm_center))*(v(Dp_center)-v(Dm_center))/R_Eddy4}

RCoreLosses Core 0 1.0e+000

ECondLosses Conductor 0 VALUE={

+(v(Ap_center)-v(Am_center))*i(vsens1)

++(v(Bp_center)-v(Bm_center))*i(vsens2)

++(v(Cp_center)-v(Cm_center))*i(vsens3)

++(v(Dp_center)-v(Dm_center))*i(vsens4)

+-((v(Ap_center)-v(Am_center))*(v(Ap_center)-v(Am_center)))/R_Eddy1

+-(v(Bp_center)-v(Bm_center))*(v(Bp_center)-v(Bm_center))/R_Eddy2

+-(v(Cp_center)-v(Cm_center))*(v(Cp_center)-v(Cm_center))/R_Eddy3

+-(v(Dp_center)-v(Dm_center))*(v(Dp_center)-v(Dm_center))/R_Eddy4}

RCondLosses Conductor 0 1.0e+000


.ends

